<!-- purchase/cardConfirm.html -->
{% extends 'layout.html' %}

{% block title %}Pay for Tickets by Card{% endblock %}

{% block content %}
    <section id="cardConfirm" class="columns">
        <h3>Your Tickets</h3>
        {% if current_user.hasUnpaidTickets('Card') %}
            <form action="{{ request.path }}" method="post">
                <table id="ticketsTable">
                    <thead>
                        <tr>
                            <th>Select</th>
                            <th>Ticket Number</th>
                            <th>Name on Ticket</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for ticket in current_user.tickets %}
                            {% if ticket.paymentmethod == 'Card' and not ticket.paid %}
                                <tr id="ticket-{{ ticket.id }}">
                                    <td><input type="checkbox" name="tickets[]" id="ticketSelect-{{ ticket.id }}" value="{{ ticket.id }}" {% if tickets and ticket.id in tickets %}checked="checked" {% endif %}/></td>
                                    <td><label for="ticketSelect-{{ ticket.id }}">#{{ '%05d' % ticket.id }}</label></td>
                                    <td><label for="ticketSelect-{{ ticket.id }}">{{ ticket.name | default('Not Set') }}</label></td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
                <input type="submit" value="Pay by Card" class="button small" />
            </form>
        {% else %}
            <p>You have no unpaid tickets marked as paying for by card. Perhaps you'd like to <a href="{{ url_for('purchase.changeMethod') }}">change the payment method on some tickets</a> or <a href="{{ url_for('purchase.purchaseHome') }}">buy some more tickets</a>?</p>
        {% endif %}
    </section>
{% endblock %}